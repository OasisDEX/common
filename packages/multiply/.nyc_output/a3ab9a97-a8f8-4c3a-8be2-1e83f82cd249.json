{"D:\\Projekty\\common\\packages\\multiply\\src\\index.ts":{"path":"D:\\Projekty\\common\\packages\\multiply\\src\\index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":104}},"2":{"start":{"line":4,"column":28},"end":{"line":4,"column":60}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":144}},"4":{"start":{"line":5,"column":91},"end":{"line":5,"column":138}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":140}},"6":{"start":{"line":6,"column":89},"end":{"line":6,"column":134}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":134}},"8":{"start":{"line":7,"column":86},"end":{"line":7,"column":128}},"9":{"start":{"line":8,"column":0},"end":{"line":8,"column":128}},"10":{"start":{"line":8,"column":83},"end":{"line":8,"column":122}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":77},"end":{"line":5,"column":78}},"loc":{"start":{"line":5,"column":89},"end":{"line":5,"column":140}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":75},"end":{"line":6,"column":76}},"loc":{"start":{"line":6,"column":87},"end":{"line":6,"column":136}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":7,"column":72},"end":{"line":7,"column":73}},"loc":{"start":{"line":7,"column":84},"end":{"line":7,"column":130}},"line":7},"3":{"name":"(anonymous_3)","decl":{"start":{"line":8,"column":69},"end":{"line":8,"column":70}},"loc":{"start":{"line":8,"column":81},"end":{"line":8,"column":124}},"line":8}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":6,"5":1,"6":0,"7":1,"8":0,"9":1,"10":0},"f":{"0":6,"1":0,"2":0,"3":0},"b":{},"inputSourceMap":{"version":3,"file":"D:/Projekty/common/packages/multiply/src/index.ts","sources":["D:/Projekty/common/packages/multiply/src/index.ts"],"names":[],"mappings":";;;AAAA,6DAAoG;AAA3F,wHAAA,iBAAiB,OAAA;AAAE,sHAAA,eAAe,OAAA;AAAE,mHAAA,YAAY,OAAA;AAAE,gHAAA,SAAS,OAAA","sourcesContent":["export { getMultiplyParams, DesiredCDPState, MarketParams, VaultInfo } from './calculateMultParams';"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"eecbbd7b37e2b62b25e22c9bd84287e072444ddb","contentHash":"0448f2704e0ce0888ee7a402e62c7969aec8a554e4adbced072fe04058261ff0"},"D:\\Projekty\\common\\packages\\multiply\\src\\calculateMultParams.ts":{"path":"D:\\Projekty\\common\\packages\\multiply\\src\\calculateMultParams.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":104}},"2":{"start":{"line":4,"column":23},"end":{"line":4,"column":46}},"3":{"start":{"line":5,"column":16},"end":{"line":5,"column":43}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":126}},"5":{"start":{"line":6,"column":89},"end":{"line":6,"column":120}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":120}},"7":{"start":{"line":7,"column":86},"end":{"line":7,"column":114}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":114}},"9":{"start":{"line":8,"column":83},"end":{"line":8,"column":108}},"10":{"start":{"line":9,"column":16},"end":{"line":9,"column":43}},"11":{"start":{"line":10,"column":29},"end":{"line":10,"column":69}},"12":{"start":{"line":11,"column":26},"end":{"line":47,"column":1}},"13":{"start":{"line":12,"column":20},"end":{"line":12,"column":51}},"14":{"start":{"line":13,"column":26},"end":{"line":13,"column":57}},"15":{"start":{"line":14,"column":18},"end":{"line":14,"column":49}},"16":{"start":{"line":15,"column":18},"end":{"line":15,"column":49}},"17":{"start":{"line":16,"column":4},"end":{"line":40,"column":5}},"18":{"start":{"line":18,"column":8},"end":{"line":18,"column":361}},"19":{"start":{"line":19,"column":8},"end":{"line":19,"column":40}},"20":{"start":{"line":20,"column":8},"end":{"line":20,"column":52}},"21":{"start":{"line":23,"column":8},"end":{"line":39,"column":9}},"22":{"start":{"line":25,"column":12},"end":{"line":25,"column":371}},"23":{"start":{"line":28,"column":33},"end":{"line":28,"column":125}},"24":{"start":{"line":29,"column":12},"end":{"line":38,"column":13}},"25":{"start":{"line":31,"column":16},"end":{"line":31,"column":369}},"26":{"start":{"line":32,"column":16},"end":{"line":32,"column":48}},"27":{"start":{"line":33,"column":16},"end":{"line":33,"column":60}},"28":{"start":{"line":37,"column":16},"end":{"line":37,"column":375}},"29":{"start":{"line":41,"column":4},"end":{"line":46,"column":6}},"30":{"start":{"line":48,"column":0},"end":{"line":48,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":75},"end":{"line":6,"column":76}},"loc":{"start":{"line":6,"column":87},"end":{"line":6,"column":122}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":72},"end":{"line":7,"column":73}},"loc":{"start":{"line":7,"column":84},"end":{"line":7,"column":116}},"line":7},"2":{"name":"(anonymous_2)","decl":{"start":{"line":8,"column":69},"end":{"line":8,"column":70}},"loc":{"start":{"line":8,"column":81},"end":{"line":8,"column":110}},"line":8},"3":{"name":"(anonymous_3)","decl":{"start":{"line":11,"column":26},"end":{"line":11,"column":27}},"loc":{"start":{"line":11,"column":94},"end":{"line":47,"column":1}},"line":11}},"branchMap":{"0":{"loc":{"start":{"line":11,"column":73},"end":{"line":11,"column":92}},"type":"default-arg","locations":[{"start":{"line":11,"column":88},"end":{"line":11,"column":92}}],"line":11},"1":{"loc":{"start":{"line":16,"column":4},"end":{"line":40,"column":5}},"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":40,"column":5}},{"start":{"line":16,"column":4},"end":{"line":40,"column":5}}],"line":16},"2":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":69}},"type":"binary-expr","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":37}},{"start":{"line":16,"column":41},"end":{"line":16,"column":69}}],"line":16},"3":{"loc":{"start":{"line":23,"column":8},"end":{"line":39,"column":9}},"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":39,"column":9}},{"start":{"line":23,"column":8},"end":{"line":39,"column":9}}],"line":23},"4":{"loc":{"start":{"line":23,"column":12},"end":{"line":23,"column":79}},"type":"binary-expr","locations":[{"start":{"line":23,"column":12},"end":{"line":23,"column":40}},{"start":{"line":23,"column":44},"end":{"line":23,"column":79}}],"line":23},"5":{"loc":{"start":{"line":29,"column":12},"end":{"line":38,"column":13}},"type":"if","locations":[{"start":{"line":29,"column":12},"end":{"line":38,"column":13}},{"start":{"line":29,"column":12},"end":{"line":38,"column":13}}],"line":29}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1,"11":1,"12":1,"13":5,"14":5,"15":5,"16":5,"17":5,"18":2,"19":2,"20":2,"21":3,"22":1,"23":2,"24":2,"25":0,"26":0,"27":0,"28":2,"29":5,"30":1},"f":{"0":0,"1":0,"2":0,"3":5},"b":{"0":[1],"1":[2,3],"2":[5,4],"3":[1,2],"4":[3,2],"5":[0,2]},"inputSourceMap":{"version":3,"file":"D:/Projekty/common/packages/multiply/src/calculateMultParams.ts","sources":["D:/Projekty/common/packages/multiply/src/calculateMultParams.ts"],"names":[],"mappings":"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","sourcesContent":["import { BigNumber } from 'bignumber.js';\r\nimport { DesiredCDPState, MarketParams, VaultInfo } from './internal/types';\r\nimport { ensureBigNumber } from './internal/utils';\r\nimport { calculateParamsIncreaseMP, calculateParamsDecreaseMP } from './internal/increaseDecreaseMP'\r\n\r\nconst  getMultiplyParams = function(\r\n   \r\n    marketParams: MarketParams,\r\n    vaultInfo:VaultInfo,\r\n    desiredCdp:DesiredCDPState,\r\n    useFlashLoan: boolean = true,\r\n  ): {\r\n        debtDelta: BigNumber,\r\n        collateralDelta: BigNumber,\r\n        loanFee: BigNumber,\r\n        oazoFee: BigNumber,\r\n  }{\r\n        let debtDelta = new BigNumber(0);\r\n        let collateralDelta =  new BigNumber(0);\r\n        let loanFee =  new BigNumber(0);\r\n        let oazoFee =  new BigNumber(0);\r\n\r\n        if(desiredCdp.withdrawColl.gt(0) || desiredCdp.withdrawDai.gt(0)){\r\n              //decrease multiply\r\n              [debtDelta,collateralDelta] = calculateParamsDecreaseMP(\r\n                  marketParams.oraclePrice,\r\n                  marketParams.marketPrice,\r\n                  marketParams.OF,\r\n                  marketParams.FF,\r\n                  vaultInfo.currentCollateral.minus(desiredCdp.withdrawColl),\r\n                  vaultInfo.currentDebt.plus(desiredCdp.withdrawDai),\r\n                  desiredCdp.requiredCollRatio,\r\n                  marketParams.slippage,\r\n                  desiredCdp.providedDai,\r\n              )\r\n              debtDelta = debtDelta.times(-1);\r\n              collateralDelta = collateralDelta.times(-1);\r\n        }else{\r\n            if(desiredCdp.providedDai.gt(0) || desiredCdp.providedCollateral.gt(0)){\r\n                  //increase multiply\r\n                  [debtDelta,collateralDelta] = calculateParamsIncreaseMP(\r\n                        marketParams.oraclePrice,\r\n                        marketParams.marketPrice,\r\n                        marketParams.OF,\r\n                        marketParams.FF,\r\n                        vaultInfo.currentCollateral.plus(desiredCdp.providedCollateral),\r\n                        vaultInfo.currentDebt.minus(desiredCdp.providedDai),\r\n                        desiredCdp.requiredCollRatio,\r\n                        marketParams.slippage,\r\n                        desiredCdp.providedDai,\r\n                  )\r\n            }else{\r\n                  let currentCollRat = vaultInfo.currentCollateral.times(marketParams.oraclePrice).dividedBy(vaultInfo.currentDebt);\r\n                  if(currentCollRat.lt(desiredCdp.requiredCollRatio)){\r\n                        //decrease mult\r\n                        [debtDelta,collateralDelta] = calculateParamsDecreaseMP(\r\n                              marketParams.oraclePrice,\r\n                              marketParams.marketPrice,\r\n                              marketParams.OF,\r\n                              marketParams.FF,\r\n                              vaultInfo.currentCollateral.minus(desiredCdp.withdrawColl),\r\n                              vaultInfo.currentDebt.plus(desiredCdp.withdrawDai),\r\n                              desiredCdp.requiredCollRatio,\r\n                              marketParams.slippage,\r\n                              desiredCdp.providedDai,\r\n                        )\r\n                        debtDelta = debtDelta.times(-1);\r\n                        collateralDelta = collateralDelta.times(-1);\r\n                  }else{\r\n                        //increase mult\r\n                        [debtDelta,collateralDelta] = calculateParamsIncreaseMP(\r\n                              marketParams.oraclePrice,\r\n                              marketParams.marketPrice,\r\n                              marketParams.OF,\r\n                              marketParams.FF,\r\n                              vaultInfo.currentCollateral.plus(desiredCdp.providedCollateral),\r\n                              vaultInfo.currentDebt.minus(desiredCdp.providedDai),\r\n                              desiredCdp.requiredCollRatio,\r\n                              marketParams.slippage,\r\n                              desiredCdp.providedDai,\r\n                        )\r\n                  }\r\n            }\r\n        }\r\n\r\n        return {\r\n              debtDelta:ensureBigNumber(debtDelta),\r\n              collateralDelta:ensureBigNumber(collateralDelta),\r\n              loanFee:ensureBigNumber(loanFee),\r\n              oazoFee:ensureBigNumber(oazoFee)\r\n        }\r\n  }\r\n\r\nexport { getMultiplyParams,  DesiredCDPState, MarketParams, VaultInfo}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9ff9334d0cb739bb628297523095fed2ae834f2d","contentHash":"9451d61b659bdcca405318cd848edb7ed957f5a79becab07db9578182197dfd4"},"D:\\Projekty\\common\\packages\\multiply\\src\\internal\\types.ts":{"path":"D:\\Projekty\\common\\packages\\multiply\\src\\internal\\types.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":76}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"3":{"start":{"line":7,"column":8},"end":{"line":7,"column":61}},"4":{"start":{"line":8,"column":8},"end":{"line":8,"column":61}},"5":{"start":{"line":9,"column":8},"end":{"line":9,"column":47}},"6":{"start":{"line":10,"column":8},"end":{"line":10,"column":47}},"7":{"start":{"line":11,"column":8},"end":{"line":11,"column":55}},"8":{"start":{"line":14,"column":0},"end":{"line":14,"column":36}},"9":{"start":{"line":17,"column":8},"end":{"line":17,"column":58}},"10":{"start":{"line":18,"column":8},"end":{"line":18,"column":64}},"11":{"start":{"line":21,"column":0},"end":{"line":21,"column":30}},"12":{"start":{"line":24,"column":8},"end":{"line":24,"column":73}},"13":{"start":{"line":25,"column":8},"end":{"line":25,"column":68}},"14":{"start":{"line":26,"column":8},"end":{"line":26,"column":65}},"15":{"start":{"line":27,"column":8},"end":{"line":27,"column":67}},"16":{"start":{"line":28,"column":8},"end":{"line":28,"column":65}},"17":{"start":{"line":31,"column":0},"end":{"line":31,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":53},"end":{"line":12,"column":5}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":30},"end":{"line":19,"column":5}},"line":16},"2":{"name":"(anonymous_2)","decl":{"start":{"line":23,"column":4},"end":{"line":23,"column":5}},"loc":{"start":{"line":23,"column":85},"end":{"line":29,"column":5}},"line":23}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":1,"12":5,"13":5,"14":5,"15":5,"16":5,"17":1},"f":{"0":2,"1":2,"2":5},"b":{},"inputSourceMap":{"version":3,"file":"D:/Projekty/common/packages/multiply/src/internal/types.ts","sources":["D:/Projekty/common/packages/multiply/src/internal/types.ts"],"names":[],"mappings":";;;AACA,mCAA0C;AAI1C,MAAM,YAAY;IAMd,YAAY,QAA+B,EAAE,QAAiC,EAAE,GAA2B,EAAE,GAA4B,EAAE,KAA4B;QACjK,IAAI,CAAC,WAAW,GAAG,uBAAe,CAAC,QAAQ,CAAC,CAAC;QAC7C,IAAI,CAAC,WAAW,GAAG,uBAAe,CAAC,QAAQ,CAAC,CAAC;QAC7C,IAAI,CAAC,EAAE,GAAG,uBAAe,CAAC,GAAG,CAAC,CAAC;QAC/B,IAAI,CAAC,EAAE,GAAG,uBAAe,CAAC,GAAG,CAAC,CAAC;QAC/B,IAAI,CAAC,QAAQ,GAAG,uBAAe,CAAC,KAAK,CAAC,CAAC;IAC7C,CAAC;CACJ;AA8BoB,oCAAY;AA7BjC,MAAM,SAAS;IAGV,YAAY,KAA4B,EAAE,KAA4B;QAChE,IAAI,CAAC,WAAW,GAAG,uBAAe,CAAC,KAAK,CAAC,CAAC;QAC1C,IAAI,CAAC,iBAAiB,GAAG,uBAAe,CAAC,KAAK,CAAC,CAAC;IACtD,CAAC;CACL;AAsBS,8BAAS;AArBnB,MAAM,eAAe;IAQhB,YAAY,SAAgC,EAChC,aAAoC,EACpC,YAAmC,EACnC,YAAoC,EACpC,aAAqC;QAC3C,IAAI,CAAC,kBAAkB,GAAG,uBAAe,CAAC,aAAa,CAAC,CAAC;QACzD,IAAI,CAAC,iBAAiB,GAAG,uBAAe,CAAC,SAAS,CAAC,CAAC;QACpD,IAAI,CAAC,WAAW,GAAG,uBAAe,CAAE,YAAY,CAAC,CAAC;QAClD,IAAI,CAAC,YAAY,GAAG,uBAAe,CAAC,aAAa,CAAC,CAAC;QACnD,IAAI,CAAC,WAAW,GAAG,uBAAe,CAAE,YAAY,CAAC,CAAC;IACxD,CAAC;CACL;AAEkC,0CAAe","sourcesContent":["import { BigNumber } from 'bignumber.js';\r\nimport { ensureBigNumber } from './utils';\r\n\r\ntype ConvertableToBigNumber = number | string | BigNumber | Object;\r\n\r\nclass MarketParams {\r\n    public oraclePrice: BigNumber;\r\n    public marketPrice: BigNumber;\r\n    public FF: BigNumber;\r\n    public OF: BigNumber;\r\n    public slippage: BigNumber;\r\n    constructor(_oracleP:ConvertableToBigNumber, _marketP : ConvertableToBigNumber, _FF: ConvertableToBigNumber, _OF : ConvertableToBigNumber, _slip:ConvertableToBigNumber){\r\n          this.oraclePrice = ensureBigNumber(_oracleP);\r\n          this.marketPrice = ensureBigNumber(_marketP);\r\n          this.FF = ensureBigNumber(_FF);\r\n          this.OF = ensureBigNumber(_OF);\r\n          this.slippage = ensureBigNumber(_slip);\r\n    }\r\n}\r\nclass VaultInfo {\r\n     public currentDebt: BigNumber;\r\n     public currentCollateral: BigNumber;\r\n     constructor(_debt:ConvertableToBigNumber, _coll:ConvertableToBigNumber){\r\n           this.currentDebt = ensureBigNumber(_debt);\r\n           this.currentCollateral = ensureBigNumber(_coll);\r\n     }\r\n}\r\nclass DesiredCDPState {\r\n\r\n     public requiredCollRatio: BigNumber;\r\n     public providedCollateral: BigNumber;\r\n     public providedDai: BigNumber;\r\n     public withdrawDai: BigNumber;\r\n     public withdrawColl: BigNumber;\r\n\r\n     constructor(_reqRatio:ConvertableToBigNumber, \r\n                 _providedColl:ConvertableToBigNumber, \r\n                 _providedDai:ConvertableToBigNumber, \r\n                 _withdrawDai: ConvertableToBigNumber, \r\n                 _withdrawColl: ConvertableToBigNumber){\r\n           this.providedCollateral = ensureBigNumber(_providedColl);\r\n           this.requiredCollRatio = ensureBigNumber(_reqRatio);\r\n           this.providedDai = ensureBigNumber( _providedDai);\r\n           this.withdrawColl = ensureBigNumber(_withdrawColl);\r\n           this.withdrawDai = ensureBigNumber( _withdrawDai);\r\n     }\r\n}\r\nexport type { ConvertableToBigNumber };\r\nexport {  VaultInfo, MarketParams, DesiredCDPState }"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3952caebc2e18374ac5df957ba6602c372aab314","contentHash":"31718f9058197ed4446c9707c6a7aa4263c413412e272dd65c9934c63686bc98"},"D:\\Projekty\\common\\packages\\multiply\\src\\internal\\utils.ts":{"path":"D:\\Projekty\\common\\packages\\multiply\\src\\internal\\utils.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":33}},"2":{"start":{"line":4,"column":23},"end":{"line":4,"column":46}},"3":{"start":{"line":5,"column":24},"end":{"line":30,"column":1}},"4":{"start":{"line":7,"column":4},"end":{"line":28,"column":5}},"5":{"start":{"line":8,"column":8},"end":{"line":23,"column":9}},"6":{"start":{"line":9,"column":12},"end":{"line":9,"column":61}},"7":{"start":{"line":12,"column":12},"end":{"line":22,"column":13}},"8":{"start":{"line":13,"column":16},"end":{"line":13,"column":76}},"9":{"start":{"line":16,"column":16},"end":{"line":21,"column":17}},"10":{"start":{"line":17,"column":20},"end":{"line":17,"column":39}},"11":{"start":{"line":20,"column":20},"end":{"line":20,"column":43}},"12":{"start":{"line":26,"column":8},"end":{"line":26,"column":24}},"13":{"start":{"line":27,"column":8},"end":{"line":27,"column":48}},"14":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"15":{"start":{"line":31,"column":0},"end":{"line":31,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":24},"end":{"line":5,"column":25}},"loc":{"start":{"line":5,"column":45},"end":{"line":30,"column":1}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":8},"end":{"line":23,"column":9}},"type":"if","locations":[{"start":{"line":8,"column":8},"end":{"line":23,"column":9}},{"start":{"line":8,"column":8},"end":{"line":23,"column":9}}],"line":8},"1":{"loc":{"start":{"line":8,"column":12},"end":{"line":8,"column":72}},"type":"binary-expr","locations":[{"start":{"line":8,"column":12},"end":{"line":8,"column":40}},{"start":{"line":8,"column":44},"end":{"line":8,"column":72}}],"line":8},"2":{"loc":{"start":{"line":12,"column":12},"end":{"line":22,"column":13}},"type":"if","locations":[{"start":{"line":12,"column":12},"end":{"line":22,"column":13}},{"start":{"line":12,"column":12},"end":{"line":22,"column":13}}],"line":12},"3":{"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":120}},"type":"binary-expr","locations":[{"start":{"line":12,"column":16},"end":{"line":12,"column":72}},{"start":{"line":12,"column":76},"end":{"line":12,"column":120}}],"line":12},"4":{"loc":{"start":{"line":16,"column":16},"end":{"line":21,"column":17}},"type":"if","locations":[{"start":{"line":16,"column":16},"end":{"line":21,"column":17}},{"start":{"line":16,"column":16},"end":{"line":21,"column":17}}],"line":16}},"s":{"0":1,"1":1,"2":1,"3":1,"4":59,"5":59,"6":38,"7":21,"8":21,"9":0,"10":0,"11":0,"12":0,"13":0,"14":59,"15":1},"f":{"0":59},"b":{"0":[38,21],"1":[59,21],"2":[21,0],"3":[21,21],"4":[0,0]},"inputSourceMap":{"version":3,"file":"D:/Projekty/common/packages/multiply/src/internal/utils.ts","sources":["D:/Projekty/common/packages/multiply/src/internal/utils.ts"],"names":[],"mappings":";;;AACA,+CAAyC;AAEzC,MAAM,eAAe,GAAG,UAAS,SAAkC;IAC/D,IAAI,MAAkB,CAAC;IACvB,IAAI;QACE,IAAI,OAAO,SAAS,IAAI,QAAQ,IAAI,OAAO,SAAS,IAAI,QAAQ,EAAE;YAChE,MAAM,GAAG,IAAI,wBAAS,CAAC,SAAS,CAAC,CAAA;SAClC;aAAM;YACL,IAAI,wBAAS,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,KAAK,IAAI,SAAS,CAAC,cAAc,CAAC,SAAS,CAAC,IAAI,KAAK,EAAE;gBAC7F,MAAM,GAAG,IAAI,wBAAS,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAA;aAC7C;iBAAI;gBACH,IAAG,wBAAS,CAAC,WAAW,CAAC,SAAS,CAAC,EAAC;oBAClC,MAAM,GAAG,SAAS,CAAC;iBACpB;qBAAI;oBACH,MAAM,gBAAgB,CAAC;iBACxB;aACF;SACF;KACF;IAAC,OAAO,EAAE,EAAE;QACX,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,CAAA;QACf,MAAM,iCAAiC,CAAA;KACxC;IACL,OAAO,MAAM,CAAC;AAClB,CAAC,CAAA;AAEQ,0CAAe","sourcesContent":["import {ConvertableToBigNumber} from './types';\r\nimport { BigNumber } from 'bignumber.js';\r\n\r\nconst ensureBigNumber = function(candidate : ConvertableToBigNumber) : BigNumber{\r\n    let retVal : BigNumber;\r\n    try {\r\n          if (typeof candidate == 'number' || typeof candidate == 'string') {\r\n            retVal = new BigNumber(candidate)\r\n          } else {\r\n            if (BigNumber.isBigNumber(candidate) == false || candidate.hasOwnProperty('toFixed') == false) {\r\n              retVal = new BigNumber(candidate.toString())\r\n            }else{\r\n              if(BigNumber.isBigNumber(candidate)){\r\n                retVal = candidate;\r\n              }else{\r\n                throw \"not impemented\";\r\n              }\r\n            }\r\n          }\r\n        } catch (ex) {\r\n          console.log(ex)\r\n          throw `Conversion for BigNumber failed`\r\n        }\r\n    return retVal;\r\n}\r\n\r\nexport { ensureBigNumber };\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7fc9fe7d6f7de5563b757c89e83d99ecb56e4ed4","contentHash":"5e84a0a722a21e0e8a6c2f8264fc653ca744a56231792edd955826ba39865596"},"D:\\Projekty\\common\\packages\\multiply\\src\\internal\\increaseDecreaseMP.ts":{"path":"D:\\Projekty\\common\\packages\\multiply\\src\\internal\\increaseDecreaseMP.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":79}},"2":{"start":{"line":4,"column":23},"end":{"line":4,"column":46}},"3":{"start":{"line":5,"column":12},"end":{"line":5,"column":43}},"4":{"start":{"line":6,"column":34},"end":{"line":33,"column":1}},"5":{"start":{"line":7,"column":4},"end":{"line":16,"column":5}},"6":{"start":{"line":8,"column":8},"end":{"line":8,"column":85}},"7":{"start":{"line":9,"column":8},"end":{"line":9,"column":85}},"8":{"start":{"line":10,"column":8},"end":{"line":10,"column":67}},"9":{"start":{"line":11,"column":8},"end":{"line":11,"column":67}},"10":{"start":{"line":12,"column":8},"end":{"line":12,"column":85}},"11":{"start":{"line":13,"column":8},"end":{"line":13,"column":85}},"12":{"start":{"line":14,"column":8},"end":{"line":14,"column":97}},"13":{"start":{"line":15,"column":8},"end":{"line":15,"column":79}},"14":{"start":{"line":17,"column":32},"end":{"line":17,"column":69}},"15":{"start":{"line":18,"column":17},"end":{"line":24,"column":49}},"16":{"start":{"line":25,"column":17},"end":{"line":25,"column":97}},"17":{"start":{"line":26,"column":23},"end":{"line":26,"column":37}},"18":{"start":{"line":27,"column":23},"end":{"line":27,"column":73}},"19":{"start":{"line":28,"column":4},"end":{"line":31,"column":5}},"20":{"start":{"line":29,"column":8},"end":{"line":29,"column":81}},"21":{"start":{"line":30,"column":8},"end":{"line":30,"column":93}},"22":{"start":{"line":32,"column":4},"end":{"line":32,"column":52}},"23":{"start":{"line":34,"column":0},"end":{"line":34,"column":62}},"24":{"start":{"line":35,"column":34},"end":{"line":62,"column":1}},"25":{"start":{"line":36,"column":4},"end":{"line":45,"column":5}},"26":{"start":{"line":37,"column":8},"end":{"line":37,"column":85}},"27":{"start":{"line":38,"column":8},"end":{"line":38,"column":85}},"28":{"start":{"line":39,"column":8},"end":{"line":39,"column":67}},"29":{"start":{"line":40,"column":8},"end":{"line":40,"column":67}},"30":{"start":{"line":41,"column":8},"end":{"line":41,"column":85}},"31":{"start":{"line":42,"column":8},"end":{"line":42,"column":85}},"32":{"start":{"line":43,"column":8},"end":{"line":43,"column":97}},"33":{"start":{"line":44,"column":8},"end":{"line":44,"column":79}},"34":{"start":{"line":46,"column":32},"end":{"line":46,"column":70}},"35":{"start":{"line":47,"column":17},"end":{"line":53,"column":61}},"36":{"start":{"line":54,"column":23},"end":{"line":54,"column":81}},"37":{"start":{"line":55,"column":17},"end":{"line":55,"column":97}},"38":{"start":{"line":56,"column":23},"end":{"line":56,"column":37}},"39":{"start":{"line":57,"column":4},"end":{"line":60,"column":5}},"40":{"start":{"line":58,"column":8},"end":{"line":58,"column":81}},"41":{"start":{"line":59,"column":8},"end":{"line":59,"column":93}},"42":{"start":{"line":61,"column":4},"end":{"line":61,"column":52}},"43":{"start":{"line":63,"column":0},"end":{"line":63,"column":62}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":34},"end":{"line":6,"column":35}},"loc":{"start":{"line":6,"column":194},"end":{"line":33,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":35,"column":34},"end":{"line":35,"column":35}},"loc":{"start":{"line":35,"column":194},"end":{"line":62,"column":1}},"line":35}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":133},"end":{"line":6,"column":177}},"type":"default-arg","locations":[{"start":{"line":6,"column":146},"end":{"line":6,"column":177}}],"line":6},"1":{"loc":{"start":{"line":6,"column":179},"end":{"line":6,"column":192}},"type":"default-arg","locations":[{"start":{"line":6,"column":187},"end":{"line":6,"column":192}}],"line":6},"2":{"loc":{"start":{"line":7,"column":4},"end":{"line":16,"column":5}},"type":"if","locations":[{"start":{"line":7,"column":4},"end":{"line":16,"column":5}},{"start":{"line":7,"column":4},"end":{"line":16,"column":5}}],"line":7},"3":{"loc":{"start":{"line":28,"column":4},"end":{"line":31,"column":5}},"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":31,"column":5}},{"start":{"line":28,"column":4},"end":{"line":31,"column":5}}],"line":28},"4":{"loc":{"start":{"line":35,"column":133},"end":{"line":35,"column":177}},"type":"default-arg","locations":[{"start":{"line":35,"column":146},"end":{"line":35,"column":177}}],"line":35},"5":{"loc":{"start":{"line":35,"column":179},"end":{"line":35,"column":192}},"type":"default-arg","locations":[{"start":{"line":35,"column":187},"end":{"line":35,"column":192}}],"line":35},"6":{"loc":{"start":{"line":36,"column":4},"end":{"line":45,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":45,"column":5}},{"start":{"line":36,"column":4},"end":{"line":45,"column":5}}],"line":36},"7":{"loc":{"start":{"line":57,"column":4},"end":{"line":60,"column":5}},"type":"if","locations":[{"start":{"line":57,"column":4},"end":{"line":60,"column":5}},{"start":{"line":57,"column":4},"end":{"line":60,"column":5}}],"line":57}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":3,"15":3,"16":3,"17":3,"18":3,"19":3,"20":0,"21":0,"22":3,"23":1,"24":1,"25":2,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":2,"35":2,"36":2,"37":2,"38":2,"39":2,"40":0,"41":0,"42":2,"43":1},"f":{"0":3,"1":2},"b":{"0":[0],"1":[3],"2":[0,3],"3":[0,3],"4":[0],"5":[2],"6":[0,2],"7":[0,2]},"inputSourceMap":{"version":3,"file":"D:/Projekty/common/packages/multiply/src/internal/increaseDecreaseMP.ts","sources":["D:/Projekty/common/packages/multiply/src/internal/increaseDecreaseMP.ts"],"names":[],"mappings":";;;AACA,+CAAyC;AAEzC,MAAM,GAAG,GAAG,IAAI,wBAAS,CAAC,CAAC,CAAC,CAAC;AAC7B,MAAM,yBAAyB,GAAG,UAC9B,WAAuB,EACvB,WAAuB,EACvB,EAAc,EACd,EAAc,EACd,WAAuB,EACvB,WAAuB,EACvB,iBAA6B,EAC7B,QAAoB,EACpB,UAAU,GAAG,IAAI,wBAAS,CAAC,CAAC,CAAC,EAC7B,KAAK,GAAG,KAAK;IAEb,IAAI,KAAK,EAAE;QACT,OAAO,CAAC,GAAG,CAAC,uCAAuC,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC5E,OAAO,CAAC,GAAG,CAAC,uCAAuC,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC5E,OAAO,CAAC,GAAG,CAAC,8BAA8B,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC1D,OAAO,CAAC,GAAG,CAAC,8BAA8B,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC1D,OAAO,CAAC,GAAG,CAAC,uCAAuC,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC5E,OAAO,CAAC,GAAG,CAAC,uCAAuC,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC5E,OAAO,CAAC,GAAG,CAAC,6CAA6C,EAAE,iBAAiB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QACxF,OAAO,CAAC,GAAG,CAAC,oCAAoC,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;KACvE;IACD,MAAM,mBAAmB,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAA;IACjE,MAAM,IAAI,GAAG,mBAAmB;SAC7B,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,iBAAiB,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC;SACjF,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;SAClF,GAAG,CACF,mBAAmB;SAChB,KAAK,CAAC,iBAAiB,CAAC;SACxB,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACnB,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAC3C,CAAA;IAEH,IAAI,MAAM,GAAG,WAAW,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;IAC9F,IAAI,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;IAClC,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAA;IACrE,IAAI,KAAK,EAAE;QACT,OAAO,CAAC,GAAG,CAAC,0CAA0C,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QACxE,OAAO,CAAC,GAAG,CAAC,gDAAgD,EAAE,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;KACrF;IACD,OAAO,CAAC,IAAI,EAAE,UAAU,EAAE,MAAM,EAAE,YAAY,CAAC,CAAA;AACjD,CAAC,CAAA;AA6CM,8DAAyB;AA1ChC,MAAM,yBAAyB,GAAG,UAChC,WAAuB,EACvB,WAAuB,EACvB,EAAc,EACd,EAAc,EACd,WAAuB,EACvB,WAAuB,EACvB,iBAA6B,EAC7B,QAAoB,EACpB,UAAU,GAAG,IAAI,wBAAS,CAAC,CAAC,CAAC,EAC7B,KAAK,GAAG,KAAK;IAEb,IAAI,KAAK,EAAE;QACT,OAAO,CAAC,GAAG,CAAC,uCAAuC,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC5E,OAAO,CAAC,GAAG,CAAC,uCAAuC,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC5E,OAAO,CAAC,GAAG,CAAC,8BAA8B,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC1D,OAAO,CAAC,GAAG,CAAC,8BAA8B,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC1D,OAAO,CAAC,GAAG,CAAC,uCAAuC,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC5E,OAAO,CAAC,GAAG,CAAC,uCAAuC,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QAC5E,OAAO,CAAC,GAAG,CAAC,6CAA6C,EAAE,iBAAiB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QACxF,OAAO,CAAC,GAAG,CAAC,oCAAoC,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;KACvE;IACD,MAAM,mBAAmB,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAA;IAClE,MAAM,IAAI,GAAG,WAAW;SACrB,KAAK,CAAC,WAAW,CAAC;SAClB,KAAK,CAAC,mBAAmB,CAAC;SAC1B,KAAK,CAAC,iBAAiB,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC;SACtE,GAAG,CACF,WAAW;SACR,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;SAC/C,KAAK,CAAC,mBAAmB,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,CACvD,CAAA;IACH,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAA;IAC7E,IAAI,MAAM,GAAG,WAAW,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;IAC9F,IAAI,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;IAClC,IAAI,KAAK,EAAE;QACT,OAAO,CAAC,GAAG,CAAC,0CAA0C,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;QACxE,OAAO,CAAC,GAAG,CAAC,gDAAgD,EAAE,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;KACrF;IACD,OAAO,CAAC,IAAI,EAAE,UAAU,EAAE,MAAM,EAAE,YAAY,CAAC,CAAA;AACjD,CAAC,CAAA;AAEiC,8DAAyB","sourcesContent":["\r\nimport { BigNumber } from 'bignumber.js';\r\n\r\nconst one = new BigNumber(1);\r\nconst calculateParamsIncreaseMP = function (\r\n    oraclePrice : BigNumber,\r\n    marketPrice : BigNumber,\r\n    OF : BigNumber,\r\n    FF : BigNumber,\r\n    currentColl : BigNumber,\r\n    currentDebt : BigNumber,\r\n    requiredCollRatio : BigNumber,\r\n    slippage : BigNumber,\r\n    depositDai = new BigNumber(0),\r\n    debug = false,\r\n  ) {\r\n    if (debug) {\r\n      console.log('calculateParamsIncreaseMP.oraclePrice', oraclePrice.toFixed(2))\r\n      console.log('calculateParamsIncreaseMP.marketPrice', marketPrice.toFixed(2))\r\n      console.log('calculateParamsIncreaseMP.OF', OF.toFixed(5))\r\n      console.log('calculateParamsIncreaseMP.FF', FF.toFixed(5))\r\n      console.log('calculateParamsIncreaseMP.currentColl', currentColl.toFixed(2))\r\n      console.log('calculateParamsIncreaseMP.currentDebt', currentDebt.toFixed(2))\r\n      console.log('calculateParamsIncreaseMP.requiredCollRatio', requiredCollRatio.toFixed(2))\r\n      console.log('calculateParamsIncreaseMP.slippage', slippage.toFixed(2))\r\n    }\r\n    const marketPriceSlippage = marketPrice.times(one.plus(slippage))\r\n    const debt = marketPriceSlippage\r\n      .times(currentColl.times(oraclePrice).minus(requiredCollRatio.times(currentDebt)))\r\n      .plus(oraclePrice.times(depositDai).minus(oraclePrice.times(depositDai).times(OF)))\r\n      .div(\r\n        marketPriceSlippage\r\n          .times(requiredCollRatio)\r\n          .times(one.plus(FF))\r\n          .minus(oraclePrice.times(one.minus(OF))),\r\n      )\r\n\r\n    let ourFee = oraclePrice.times(depositDai).times(OF).plus(debt.times(one.plus(FF)).times(OF)); \r\n    let flashLoanFee = debt.times(FF);\r\n    const collateral = debt.times(one.minus(OF)).div(marketPriceSlippage)\r\n    if (debug) {\r\n      console.log('Computed: calculateParamsIncreaseMP.debt', debt.toFixed(2))\r\n      console.log('Computed: calculateParamsIncreaseMP.collateral', collateral.toFixed(2))\r\n    }\r\n    return [debt, collateral, ourFee, flashLoanFee]\r\n  }\r\n\r\n\r\n  const calculateParamsDecreaseMP = function (\r\n    oraclePrice : BigNumber,\r\n    marketPrice : BigNumber,\r\n    OF : BigNumber,\r\n    FF : BigNumber,\r\n    currentColl : BigNumber,\r\n    currentDebt : BigNumber,\r\n    requiredCollRatio : BigNumber,\r\n    slippage : BigNumber,\r\n    depositDai = new BigNumber(0),\r\n    debug = false,\r\n  ) {\r\n    if (debug) {\r\n      console.log('calculateParamsDecreaseMP.oraclePrice', oraclePrice.toFixed(2))\r\n      console.log('calculateParamsDecreaseMP.marketPrice', marketPrice.toFixed(2))\r\n      console.log('calculateParamsDecreaseMP.OF', OF.toFixed(5))\r\n      console.log('calculateParamsDecreaseMP.FF', FF.toFixed(5))\r\n      console.log('calculateParamsDecreaseMP.currentColl', currentColl.toFixed(2))\r\n      console.log('calculateParamsDecreaseMP.currentDebt', currentDebt.toFixed(2))\r\n      console.log('calculateParamsDecreaseMP.requiredCollRatio', requiredCollRatio.toFixed(2))\r\n      console.log('calculateParamsDecreaseMP.slippage', slippage.toFixed(2))\r\n    }\r\n    const marketPriceSlippage = marketPrice.times(one.minus(slippage))\r\n    const debt = currentColl\r\n      .times(oraclePrice)\r\n      .times(marketPriceSlippage)\r\n      .minus(requiredCollRatio.times(currentDebt).times(marketPriceSlippage))\r\n      .div(\r\n        oraclePrice\r\n          .times(one.plus(FF).plus(OF).plus(OF.times(FF)))\r\n          .minus(marketPriceSlippage.times(requiredCollRatio)),\r\n      )\r\n    const collateral = debt.times(one.plus(OF).plus(FF)).div(marketPriceSlippage)\r\n    let ourFee = oraclePrice.times(depositDai).times(OF).plus(debt.times(one.plus(FF)).times(OF)); \r\n    let flashLoanFee = debt.times(FF);\r\n    if (debug) {\r\n      console.log('Computed: calculateParamsDecreaseMP.debt', debt.toFixed(2))\r\n      console.log('Computed: calculateParamsDecreaseMP.collateral', collateral.toFixed(2))\r\n    }\r\n    return [debt, collateral, ourFee, flashLoanFee]\r\n  }\r\n  \r\nexport { calculateParamsIncreaseMP, calculateParamsDecreaseMP }"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6eefb10403e200d432858e9e791d1e0957b200e5","contentHash":"1d47d03251880b9144f4c5235a97671c411bf48963ee4718f6d610e49844d15a"}}